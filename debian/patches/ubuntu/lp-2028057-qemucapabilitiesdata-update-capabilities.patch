From 603c6b840fb7a5714d49fd61e293e94113ad4811 Mon Sep 17 00:00:00 2001
From: Peter Krempa <pkrempa@redhat.com>
Date: Wed, 1 Mar 2023 12:57:17 +0100
Subject: [PATCH] tests: qemucapabilitiesdata: Update capabilities for the
 qemu-8.0 dev cycle on x86_64

Notable changes:

 - 'SapphireRapids(-v1)' cpu model added
 - 'fsrs', 'fsrc', 'fzrm' cpu features added and available via TCG
 - 'fsrm' feature can be now emulated by qemu

Signed-off-by: Peter Krempa <pkrempa@redhat.com>
Reviewed-by: JÃ¡n Tomko <jtomko@redhat.com>

Origin: backport, https://gitlab.com/libvirt/libvirt/-/commit/603c6b840fb7a5714d49fd61e293e94113ad4811
Bug-Ubuntu: https://bugs.launchpad.net/bugs/2028057
Last-Update: 2023-10-27

--- a/tests/domaincapsdata/qemu_8.0.0-tcg.x86_64.xml
+++ b/tests/domaincapsdata/qemu_8.0.0-tcg.x86_64.xml
@@ -51,6 +51,7 @@
       <feature policy='require' name='vaes'/>
       <feature policy='require' name='la57'/>
       <feature policy='require' name='pks'/>
+      <feature policy='require' name='fsrm'/>
       <feature policy='require' name='3dnowext'/>
       <feature policy='require' name='3dnow'/>
       <feature policy='require' name='npt'/>
--- a/tests/qemucapabilitiesdata/caps_8.0.0.x86_64.replies
+++ b/tests/qemucapabilitiesdata/caps_8.0.0.x86_64.replies
@@ -23661,6 +23661,10 @@
       "parent": "x86_64-cpu"
     },
     {
+      "name": "vhost-scsi-pci-transitional",
+      "parent": "vhost-scsi-pci-base"
+    },
+    {
       "name": "usb-storage",
       "parent": "usb-storage-dev"
     },
@@ -23677,8 +23681,8 @@
       "parent": "generic-pc-machine"
     },
     {
-      "name": "vhost-scsi-pci-transitional",
-      "parent": "vhost-scsi-pci-base"
+      "name": "SapphireRapids-v1-x86_64-cpu",
+      "parent": "x86_64-cpu"
     },
     {
       "name": "isa-i8259",
@@ -24297,6 +24301,10 @@
       "parent": "pcie-host-bridge"
     },
     {
+      "name": "SapphireRapids-x86_64-cpu",
+      "parent": "x86_64-cpu"
+    },
+    {
       "name": "pc-i440fx-2.0-machine",
       "parent": "generic-pc-machine"
     },
@@ -29309,6 +29317,10 @@
       "type": "bool"
     },
     {
+      "name": "vmx-hlt-exit",
+      "type": "bool"
+    },
+    {
       "name": "cldemote",
       "type": "bool"
     },
@@ -29334,7 +29346,7 @@
       "type": "bool"
     },
     {
-      "name": "vmx-hlt-exit",
+      "name": "fsrs",
       "type": "bool"
     },
     {
@@ -29908,6 +29920,11 @@
       "type": "bool"
     },
     {
+      "name": "hv-vpindex",
+      "description": "on/off",
+      "type": "bool"
+    },
+    {
       "name": "ds",
       "type": "bool"
     },
@@ -29924,8 +29941,7 @@
       "type": "bool"
     },
     {
-      "name": "hv-vpindex",
-      "description": "on/off",
+      "name": "fsrc",
       "type": "bool"
     },
     {
@@ -29985,6 +30001,10 @@
       "type": "bool"
     },
     {
+      "name": "fzrm",
+      "type": "bool"
+    },
+    {
       "name": "serialize",
       "type": "bool"
     },
@@ -32015,6 +32035,113 @@
       "deprecated": false
     },
     {
+      "name": "SapphireRapids-v1",
+      "typename": "SapphireRapids-v1-x86_64-cpu",
+      "unavailable-features": [
+        "pcid",
+        "hle",
+        "erms",
+        "invpcid",
+        "rtm",
+        "avx512f",
+        "avx512dq",
+        "avx512ifma",
+        "avx512cd",
+        "avx512bw",
+        "avx512vl",
+        "avx512vbmi",
+        "pku",
+        "avx512vbmi2",
+        "gfni",
+        "vaes",
+        "vpclmulqdq",
+        "avx512vnni",
+        "avx512bitalg",
+        "avx512-vpopcntdq",
+        "la57",
+        "bus-lock-detect",
+        "fsrm",
+        "serialize",
+        "tsx-ldtrk",
+        "amx-bf16",
+        "avx512-fp16",
+        "amx-tile",
+        "amx-int8",
+        "spec-ctrl",
+        "avx-vnni",
+        "avx512-bf16",
+        "fzrm",
+        "fsrs",
+        "fsrc",
+        "xfd",
+        "avx512f",
+        "avx512f",
+        "avx512f",
+        "pku",
+        "amx-tile",
+        "amx-tile",
+        "ibrs-all",
+        "taa-no"
+      ],
+      "static": false,
+      "migration-safe": true,
+      "deprecated": false
+    },
+    {
+      "name": "SapphireRapids",
+      "typename": "SapphireRapids-x86_64-cpu",
+      "unavailable-features": [
+        "pcid",
+        "hle",
+        "erms",
+        "invpcid",
+        "rtm",
+        "avx512f",
+        "avx512dq",
+        "avx512ifma",
+        "avx512cd",
+        "avx512bw",
+        "avx512vl",
+        "avx512vbmi",
+        "pku",
+        "avx512vbmi2",
+        "gfni",
+        "vaes",
+        "vpclmulqdq",
+        "avx512vnni",
+        "avx512bitalg",
+        "avx512-vpopcntdq",
+        "la57",
+        "bus-lock-detect",
+        "fsrm",
+        "serialize",
+        "tsx-ldtrk",
+        "amx-bf16",
+        "avx512-fp16",
+        "amx-tile",
+        "amx-int8",
+        "spec-ctrl",
+        "avx-vnni",
+        "avx512-bf16",
+        "fzrm",
+        "fsrs",
+        "fsrc",
+        "xfd",
+        "avx512f",
+        "avx512f",
+        "avx512f",
+        "pku",
+        "amx-tile",
+        "amx-tile",
+        "ibrs-all",
+        "taa-no"
+      ],
+      "alias-of": "SapphireRapids-v1",
+      "static": false,
+      "migration-safe": true,
+      "deprecated": false
+    },
+    {
       "name": "SandyBridge-v2",
       "typename": "SandyBridge-v2-x86_64-cpu",
       "unavailable-features": [
@@ -35119,6 +35246,7 @@
         "fma": true,
         "cx16": true,
         "de": true,
+        "fzrm": false,
         "stepping": 0,
         "xsave": true,
         "clflush": true,
@@ -35180,6 +35308,8 @@
         "vmx-exit-save-preemption-timer": false,
         "vmx-entry-load-pat": false,
         "fsrm": false,
+        "fsrs": false,
+        "fsrc": false,
         "vmx-entry-load-perf-global-ctrl": false,
         "vmx-io-bitmap": false,
         "umip": true,
@@ -35471,6 +35601,7 @@
         "fma": true,
         "cx16": true,
         "de": true,
+        "fzrm": false,
         "stepping": 0,
         "xsave": true,
         "clflush": true,
@@ -35532,6 +35663,8 @@
         "vmx-exit-save-preemption-timer": false,
         "vmx-entry-load-pat": false,
         "fsrm": false,
+        "fsrs": false,
+        "fsrc": false,
         "vmx-entry-load-perf-global-ctrl": false,
         "vmx-io-bitmap": false,
         "umip": true,
@@ -35887,6 +36020,7 @@
         "vmx-exit-load-perf-global-ctrl": false,
         "fma": true,
         "cx16": true,
+        "fzrm": false,
         "de": true,
         "hv-version-id-build": 14393,
         "enforce": false,
@@ -35967,7 +36101,9 @@
         "lm": true,
         "vmx-exit-save-preemption-timer": false,
         "vmx-entry-load-pat": false,
+        "fsrs": false,
         "fsrm": false,
+        "fsrc": false,
         "vmx-entry-load-perf-global-ctrl": false,
         "vmx-io-bitmap": false,
         "vmx-store-lma": false,
@@ -36825,6 +36961,115 @@
       "deprecated": false
     },
     {
+      "name": "SapphireRapids-v1",
+      "typename": "SapphireRapids-v1-x86_64-cpu",
+      "unavailable-features": [
+        "pcid",
+        "x2apic",
+        "tsc-deadline",
+        "hle",
+        "invpcid",
+        "rtm",
+        "avx512f",
+        "avx512dq",
+        "rdseed",
+        "avx512ifma",
+        "avx512cd",
+        "sha-ni",
+        "avx512bw",
+        "avx512vl",
+        "avx512vbmi",
+        "avx512vbmi2",
+        "gfni",
+        "vpclmulqdq",
+        "avx512vnni",
+        "avx512bitalg",
+        "avx512-vpopcntdq",
+        "rdpid",
+        "bus-lock-detect",
+        "serialize",
+        "tsx-ldtrk",
+        "amx-bf16",
+        "avx512-fp16",
+        "amx-tile",
+        "amx-int8",
+        "spec-ctrl",
+        "arch-capabilities",
+        "ssbd",
+        "avx-vnni",
+        "avx512-bf16",
+        "3dnowprefetch",
+        "wbnoinvd",
+        "xsavec",
+        "xsaves",
+        "xfd",
+        "rdctl-no",
+        "ibrs-all",
+        "skip-l1dfl-vmentry",
+        "mds-no",
+        "pschange-mc-no",
+        "taa-no"
+      ],
+      "static": false,
+      "migration-safe": true,
+      "deprecated": false
+    },
+    {
+      "name": "SapphireRapids",
+      "typename": "SapphireRapids-x86_64-cpu",
+      "unavailable-features": [
+        "pcid",
+        "x2apic",
+        "tsc-deadline",
+        "hle",
+        "invpcid",
+        "rtm",
+        "avx512f",
+        "avx512dq",
+        "rdseed",
+        "avx512ifma",
+        "avx512cd",
+        "sha-ni",
+        "avx512bw",
+        "avx512vl",
+        "avx512vbmi",
+        "avx512vbmi2",
+        "gfni",
+        "vpclmulqdq",
+        "avx512vnni",
+        "avx512bitalg",
+        "avx512-vpopcntdq",
+        "rdpid",
+        "bus-lock-detect",
+        "serialize",
+        "tsx-ldtrk",
+        "amx-bf16",
+        "avx512-fp16",
+        "amx-tile",
+        "amx-int8",
+        "spec-ctrl",
+        "arch-capabilities",
+        "ssbd",
+        "avx-vnni",
+        "avx512-bf16",
+        "3dnowprefetch",
+        "wbnoinvd",
+        "xsavec",
+        "xsaves",
+        "xfd",
+        "rdctl-no",
+        "ibrs-all",
+        "skip-l1dfl-vmentry",
+        "mds-no",
+        "pschange-mc-no",
+        "taa-no"
+      ],
+      "alias-of": "SapphireRapids-v1",
+      "static": false,
+      "migration-safe": true,
+      "deprecated": false
+    },
+    {
       "name": "SandyBridge-v2",
       "typename": "SandyBridge-v2-x86_64-cpu",
       "unavailable-features": [
@@ -37163,7 +37408,6 @@
         "avx512bitalg",
         "avx512-vpopcntdq",
         "rdpid",
-        "fsrm",
         "spec-ctrl",
         "arch-capabilities",
         "ssbd",
@@ -37206,7 +37450,6 @@
         "avx512bitalg",
         "avx512-vpopcntdq",
         "rdpid",
-        "fsrm",
         "spec-ctrl",
         "arch-capabilities",
         "ssbd",
@@ -37249,7 +37492,6 @@
         "avx512bitalg",
         "avx512-vpopcntdq",
         "rdpid",
-        "fsrm",
         "spec-ctrl",
         "arch-capabilities",
         "ssbd",
@@ -37705,7 +37947,6 @@
         "rdseed",
         "sha-ni",
         "rdpid",
-        "fsrm",
         "fxsr-opt",
         "misalignsse",
         "3dnowprefetch",
@@ -37736,7 +37977,6 @@
         "rdseed",
         "sha-ni",
         "rdpid",
-        "fsrm",
         "fxsr-opt",
         "misalignsse",
         "3dnowprefetch",
@@ -38629,6 +38869,7 @@
         "fma": true,
         "cx16": true,
         "de": true,
+        "fzrm": true,
         "stepping": 1,
         "xsave": true,
         "clflush": true,
@@ -38689,7 +38930,9 @@
         "lm": true,
         "vmx-exit-save-preemption-timer": false,
         "vmx-entry-load-pat": false,
-        "fsrm": false,
+        "fsrm": true,
+        "fsrs": true,
+        "fsrc": true,
         "vmx-entry-load-perf-global-ctrl": false,
         "vmx-io-bitmap": false,
         "umip": true,
@@ -38981,6 +39224,7 @@
         "fma": true,
         "cx16": true,
         "de": true,
+        "fzrm": true,
         "stepping": 1,
         "xsave": true,
         "clflush": true,
@@ -39041,7 +39285,9 @@
         "lm": true,
         "vmx-exit-save-preemption-timer": false,
         "vmx-entry-load-pat": false,
-        "fsrm": false,
+        "fsrm": true,
+        "fsrs": true,
+        "fsrc": true,
         "vmx-entry-load-perf-global-ctrl": false,
         "vmx-io-bitmap": false,
         "umip": true,
--- a/tests/qemucapabilitiesdata/caps_8.0.0.x86_64.xml
+++ b/tests/qemucapabilitiesdata/caps_8.0.0.x86_64.xml
@@ -398,6 +398,7 @@
     <property name='fma' type='boolean' value='true' migratable='yes'/>
     <property name='cx16' type='boolean' value='true' migratable='yes'/>
     <property name='de' type='boolean' value='true' migratable='yes'/>
+    <property name='fzrm' type='boolean' value='false'/>
     <property name='stepping' type='number' value='0'/>
     <property name='xsave' type='boolean' value='true' migratable='yes'/>
     <property name='clflush' type='boolean' value='true' migratable='yes'/>
@@ -459,6 +460,8 @@
     <property name='vmx-exit-save-preemption-timer' type='boolean' value='false'/>
     <property name='vmx-entry-load-pat' type='boolean' value='false'/>
     <property name='fsrm' type='boolean' value='false'/>
+    <property name='fsrs' type='boolean' value='false'/>
+    <property name='fsrc' type='boolean' value='false'/>
     <property name='vmx-entry-load-perf-global-ctrl' type='boolean' value='false'/>
     <property name='vmx-io-bitmap' type='boolean' value='false'/>
     <property name='umip' type='boolean' value='true' migratable='yes'/>
@@ -831,6 +834,98 @@
     <blocker name='invpcid'/>
     <blocker name='rtm'/>
   </cpu>
+  <cpu type='kvm' name='SapphireRapids-v1' typename='SapphireRapids-v1-x86_64-cpu' usable='no'>
+    <blocker name='pcid'/>
+    <blocker name='hle'/>
+    <blocker name='erms'/>
+    <blocker name='invpcid'/>
+    <blocker name='rtm'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512dq'/>
+    <blocker name='avx512ifma'/>
+    <blocker name='avx512cd'/>
+    <blocker name='avx512bw'/>
+    <blocker name='avx512vl'/>
+    <blocker name='avx512vbmi'/>
+    <blocker name='pku'/>
+    <blocker name='avx512vbmi2'/>
+    <blocker name='gfni'/>
+    <blocker name='vaes'/>
+    <blocker name='vpclmulqdq'/>
+    <blocker name='avx512vnni'/>
+    <blocker name='avx512bitalg'/>
+    <blocker name='avx512-vpopcntdq'/>
+    <blocker name='la57'/>
+    <blocker name='bus-lock-detect'/>
+    <blocker name='fsrm'/>
+    <blocker name='serialize'/>
+    <blocker name='tsx-ldtrk'/>
+    <blocker name='amx-bf16'/>
+    <blocker name='avx512-fp16'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-int8'/>
+    <blocker name='spec-ctrl'/>
+    <blocker name='avx-vnni'/>
+    <blocker name='avx512-bf16'/>
+    <blocker name='fzrm'/>
+    <blocker name='fsrs'/>
+    <blocker name='fsrc'/>
+    <blocker name='xfd'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512f'/>
+    <blocker name='pku'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-tile'/>
+    <blocker name='ibrs-all'/>
+    <blocker name='taa-no'/>
+  </cpu>
+  <cpu type='kvm' name='SapphireRapids' typename='SapphireRapids-x86_64-cpu' usable='no'>
+    <blocker name='pcid'/>
+    <blocker name='hle'/>
+    <blocker name='erms'/>
+    <blocker name='invpcid'/>
+    <blocker name='rtm'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512dq'/>
+    <blocker name='avx512ifma'/>
+    <blocker name='avx512cd'/>
+    <blocker name='avx512bw'/>
+    <blocker name='avx512vl'/>
+    <blocker name='avx512vbmi'/>
+    <blocker name='pku'/>
+    <blocker name='avx512vbmi2'/>
+    <blocker name='gfni'/>
+    <blocker name='vaes'/>
+    <blocker name='vpclmulqdq'/>
+    <blocker name='avx512vnni'/>
+    <blocker name='avx512bitalg'/>
+    <blocker name='avx512-vpopcntdq'/>
+    <blocker name='la57'/>
+    <blocker name='bus-lock-detect'/>
+    <blocker name='fsrm'/>
+    <blocker name='serialize'/>
+    <blocker name='tsx-ldtrk'/>
+    <blocker name='amx-bf16'/>
+    <blocker name='avx512-fp16'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-int8'/>
+    <blocker name='spec-ctrl'/>
+    <blocker name='avx-vnni'/>
+    <blocker name='avx512-bf16'/>
+    <blocker name='fzrm'/>
+    <blocker name='fsrs'/>
+    <blocker name='fsrc'/>
+    <blocker name='xfd'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512f'/>
+    <blocker name='pku'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-tile'/>
+    <blocker name='ibrs-all'/>
+    <blocker name='taa-no'/>
+  </cpu>
   <cpu type='kvm' name='SandyBridge-v2' typename='SandyBridge-v2-x86_64-cpu' usable='no'>
     <blocker name='spec-ctrl'/>
   </cpu>
@@ -1741,6 +1836,7 @@
     <property name='fma' type='boolean' value='true' migratable='yes'/>
     <property name='cx16' type='boolean' value='true' migratable='yes'/>
     <property name='de' type='boolean' value='true' migratable='yes'/>
+    <property name='fzrm' type='boolean' value='true' migratable='yes'/>
     <property name='stepping' type='number' value='1'/>
     <property name='xsave' type='boolean' value='true' migratable='yes'/>
     <property name='clflush' type='boolean' value='true' migratable='yes'/>
@@ -1801,7 +1897,9 @@
     <property name='lm' type='boolean' value='true' migratable='yes'/>
     <property name='vmx-exit-save-preemption-timer' type='boolean' value='false'/>
     <property name='vmx-entry-load-pat' type='boolean' value='false'/>
-    <property name='fsrm' type='boolean' value='false'/>
+    <property name='fsrm' type='boolean' value='true' migratable='yes'/>
+    <property name='fsrs' type='boolean' value='true' migratable='yes'/>
+    <property name='fsrc' type='boolean' value='true' migratable='yes'/>
     <property name='vmx-entry-load-perf-global-ctrl' type='boolean' value='false'/>
     <property name='vmx-io-bitmap' type='boolean' value='false'/>
     <property name='umip' type='boolean' value='true' migratable='yes'/>
@@ -2209,6 +2307,100 @@
     <blocker name='3dnowprefetch'/>
     <blocker name='xsavec'/>
   </cpu>
+  <cpu type='tcg' name='SapphireRapids-v1' typename='SapphireRapids-v1-x86_64-cpu' usable='no'>
+    <blocker name='pcid'/>
+    <blocker name='x2apic'/>
+    <blocker name='tsc-deadline'/>
+    <blocker name='hle'/>
+    <blocker name='invpcid'/>
+    <blocker name='rtm'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512dq'/>
+    <blocker name='rdseed'/>
+    <blocker name='avx512ifma'/>
+    <blocker name='avx512cd'/>
+    <blocker name='sha-ni'/>
+    <blocker name='avx512bw'/>
+    <blocker name='avx512vl'/>
+    <blocker name='avx512vbmi'/>
+    <blocker name='avx512vbmi2'/>
+    <blocker name='gfni'/>
+    <blocker name='vpclmulqdq'/>
+    <blocker name='avx512vnni'/>
+    <blocker name='avx512bitalg'/>
+    <blocker name='avx512-vpopcntdq'/>
+    <blocker name='rdpid'/>
+    <blocker name='bus-lock-detect'/>
+    <blocker name='serialize'/>
+    <blocker name='tsx-ldtrk'/>
+    <blocker name='amx-bf16'/>
+    <blocker name='avx512-fp16'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-int8'/>
+    <blocker name='spec-ctrl'/>
+    <blocker name='arch-capabilities'/>
+    <blocker name='ssbd'/>
+    <blocker name='avx-vnni'/>
+    <blocker name='avx512-bf16'/>
+    <blocker name='3dnowprefetch'/>
+    <blocker name='wbnoinvd'/>
+    <blocker name='xsavec'/>
+    <blocker name='xsaves'/>
+    <blocker name='xfd'/>
+    <blocker name='rdctl-no'/>
+    <blocker name='ibrs-all'/>
+    <blocker name='skip-l1dfl-vmentry'/>
+    <blocker name='mds-no'/>
+    <blocker name='pschange-mc-no'/>
+    <blocker name='taa-no'/>
+  </cpu>
+  <cpu type='tcg' name='SapphireRapids' typename='SapphireRapids-x86_64-cpu' usable='no'>
+    <blocker name='pcid'/>
+    <blocker name='x2apic'/>
+    <blocker name='tsc-deadline'/>
+    <blocker name='hle'/>
+    <blocker name='invpcid'/>
+    <blocker name='rtm'/>
+    <blocker name='avx512f'/>
+    <blocker name='avx512dq'/>
+    <blocker name='rdseed'/>
+    <blocker name='avx512ifma'/>
+    <blocker name='avx512cd'/>
+    <blocker name='sha-ni'/>
+    <blocker name='avx512bw'/>
+    <blocker name='avx512vl'/>
+    <blocker name='avx512vbmi'/>
+    <blocker name='avx512vbmi2'/>
+    <blocker name='gfni'/>
+    <blocker name='vpclmulqdq'/>
+    <blocker name='avx512vnni'/>
+    <blocker name='avx512bitalg'/>
+    <blocker name='avx512-vpopcntdq'/>
+    <blocker name='rdpid'/>
+    <blocker name='bus-lock-detect'/>
+    <blocker name='serialize'/>
+    <blocker name='tsx-ldtrk'/>
+    <blocker name='amx-bf16'/>
+    <blocker name='avx512-fp16'/>
+    <blocker name='amx-tile'/>
+    <blocker name='amx-int8'/>
+    <blocker name='spec-ctrl'/>
+    <blocker name='arch-capabilities'/>
+    <blocker name='ssbd'/>
+    <blocker name='avx-vnni'/>
+    <blocker name='avx512-bf16'/>
+    <blocker name='3dnowprefetch'/>
+    <blocker name='wbnoinvd'/>
+    <blocker name='xsavec'/>
+    <blocker name='xsaves'/>
+    <blocker name='xfd'/>
+    <blocker name='rdctl-no'/>
+    <blocker name='ibrs-all'/>
+    <blocker name='skip-l1dfl-vmentry'/>
+    <blocker name='mds-no'/>
+    <blocker name='pschange-mc-no'/>
+    <blocker name='taa-no'/>
+  </cpu>
   <cpu type='tcg' name='SandyBridge-v2' typename='SandyBridge-v2-x86_64-cpu' usable='no'>
     <blocker name='x2apic'/>
     <blocker name='tsc-deadline'/>
@@ -2342,7 +2534,6 @@
     <blocker name='avx512bitalg'/>
     <blocker name='avx512-vpopcntdq'/>
     <blocker name='rdpid'/>
-    <blocker name='fsrm'/>
     <blocker name='spec-ctrl'/>
     <blocker name='arch-capabilities'/>
     <blocker name='ssbd'/>
@@ -2378,7 +2569,6 @@
     <blocker name='avx512bitalg'/>
     <blocker name='avx512-vpopcntdq'/>
     <blocker name='rdpid'/>
-    <blocker name='fsrm'/>
     <blocker name='spec-ctrl'/>
     <blocker name='arch-capabilities'/>
     <blocker name='ssbd'/>
@@ -2414,7 +2604,6 @@
     <blocker name='avx512bitalg'/>
     <blocker name='avx512-vpopcntdq'/>
     <blocker name='rdpid'/>
-    <blocker name='fsrm'/>
     <blocker name='spec-ctrl'/>
     <blocker name='arch-capabilities'/>
     <blocker name='ssbd'/>
@@ -2723,7 +2912,6 @@
     <blocker name='rdseed'/>
     <blocker name='sha-ni'/>
     <blocker name='rdpid'/>
-    <blocker name='fsrm'/>
     <blocker name='fxsr-opt'/>
     <blocker name='misalignsse'/>
     <blocker name='3dnowprefetch'/>
@@ -2747,7 +2935,6 @@
     <blocker name='rdseed'/>
     <blocker name='sha-ni'/>
     <blocker name='rdpid'/>
-    <blocker name='fsrm'/>
     <blocker name='fxsr-opt'/>
     <blocker name='misalignsse'/>
     <blocker name='3dnowprefetch'/>
