From 4bf853cac24953a0e2855bfc74d7490bbdbf9baa Mon Sep 17 00:00:00 2001
From: Tim Wiederhake <twiederh@redhat.com>
Date: Thu, 9 Mar 2023 14:18:18 +0100
Subject: [PATCH] cpu_map: Add missing feature "fsrs"

Introduced in qemu 58794f644e.

Signed-off-by: Tim Wiederhake <twiederh@redhat.com>
Reviewed-by: Michal Privoznik <mprivozn@redhat.com>

Origin: upstream, https://gitlab.com/libvirt/libvirt/-/commit/4bf853cac24953a0e2855bfc74d7490bbdbf9baa
Bug-Ubuntu: https://bugs.launchpad.net/bugs/2028057
Last-Update: 2023-10-27

--- a/src/cpu_map/x86_features.xml
+++ b/src/cpu_map/x86_features.xml
@@ -419,6 +419,9 @@
   <feature name='fzrm'>
     <cpuid eax_in='0x07' ecx_in='0x01' eax='0x00000400'/>
   </feature>
+  <feature name='fsrs'>
+    <cpuid eax_in='0x07' ecx_in='0x01' eax='0x00000800'/>
+  </feature>
 
   <!-- Processor Extended State Enumeration sub leaf 1 -->
   <feature name='xsaveopt'>
--- a/tests/domaincapsdata/qemu_8.0.0-tcg.x86_64.xml
+++ b/tests/domaincapsdata/qemu_8.0.0-tcg.x86_64.xml
@@ -53,6 +53,7 @@
       <feature policy='require' name='pks'/>
       <feature policy='require' name='fsrm'/>
       <feature policy='require' name='fzrm'/>
+      <feature policy='require' name='fsrs'/>
       <feature policy='require' name='3dnowext'/>
       <feature policy='require' name='3dnow'/>
       <feature policy='require' name='npt'/>
