Author: Jamie Strandboge <jamie@canonical.com>
Description: fix for CVE-2010-2239. Always use '-F backingType' when creating
 backing stores, since qemu-kvm in Ubuntu 9.10 provides both qemu-img and
 kvm-img, which both support the -F option.

Index: libvirt-0.7.0/src/storage_backend.c
===================================================================
--- libvirt-0.7.0.orig/src/storage_backend.c	2010-09-01 14:42:22.000000000 -0500
+++ libvirt-0.7.0/src/storage_backend.c	2010-09-01 14:48:16.000000000 -0500
@@ -432,12 +432,10 @@
         imgargv = convargv;
     } else if (vol->backingStore.path) {
         imgargvbacking[0] = create_tool;
-        if (use_kvmimg) {
-            imgargvbacking[6] = "-F";
-            imgargvbacking[7] = backingType;
-            imgargvbacking[8] = vol->target.path;
-            imgargvbacking[9] = size;
-        }
+        imgargvbacking[6] = "-F";
+        imgargvbacking[7] = backingType;
+        imgargvbacking[8] = vol->target.path;
+        imgargvbacking[9] = size;
         imgargv = imgargvbacking;
     } else {
         imgargvnormal[0] = create_tool;
