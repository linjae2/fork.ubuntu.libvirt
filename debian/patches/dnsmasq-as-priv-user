Index: libvirt-1.0.1/src/network/bridge_driver.c
===================================================================
--- libvirt-1.0.1.orig/src/network/bridge_driver.c	2013-01-22 12:32:15.272626431 -0600
+++ libvirt-1.0.1/src/network/bridge_driver.c	2013-01-22 12:32:15.264626431 -0600
@@ -672,7 +672,8 @@
                               "## or other application using the libvirt API.\n"
                               "##\n## dnsmasq conf file created by libvirt\n"
                               "strict-order\n"
-                              "domain-needed\n",
+                              "domain-needed\n"
+                              "user=libvirt-dnsmasq\n",
                               network->def->name);
 
      if (network->def->domain) {
Index: libvirt-1.0.1/tests/networkxml2confdata/dhcp6-nat-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/dhcp6-nat-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/dhcp6-nat-network.conf	2013-01-22 13:52:26.144544973 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
Index: libvirt-1.0.1/tests/networkxml2confdata/dhcp6-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/dhcp6-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/dhcp6-network.conf	2013-01-22 13:52:28.232544938 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 domain=mynet
 expand-hosts
 local=/mynet/
Index: libvirt-1.0.1/tests/networkxml2confdata/dhcp6host-routed-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/dhcp6host-routed-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/dhcp6host-routed-network.conf	2013-01-22 13:52:20.072545076 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
Index: libvirt-1.0.1/tests/networkxml2confdata/isolated-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/isolated-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/isolated-network.conf	2013-01-22 13:52:29.960544909 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-interfaces
Index: libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-hosts.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/nat-network-dns-hosts.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-hosts.conf	2013-01-22 13:52:33.168544854 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 domain=example.com
 expand-hosts
 local=/example.com/
Index: libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-srv-record-minimal.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/nat-network-dns-srv-record-minimal.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-srv-record-minimal.conf	2013-01-22 13:52:36.484544798 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-interfaces
Index: libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-srv-record.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/nat-network-dns-srv-record.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-srv-record.conf	2013-01-22 13:52:34.876544825 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
Index: libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-txt-record.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/nat-network-dns-txt-record.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/nat-network-dns-txt-record.conf	2013-01-22 13:52:38.256544768 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
Index: libvirt-1.0.1/tests/networkxml2confdata/nat-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/nat-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/nat-network.conf	2013-01-22 13:52:31.560544882 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
Index: libvirt-1.0.1/tests/networkxml2confdata/netboot-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/netboot-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/netboot-network.conf	2013-01-22 13:52:39.864544741 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 domain=example.com
 expand-hosts
 local=/example.com/
Index: libvirt-1.0.1/tests/networkxml2confdata/netboot-proxy-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/netboot-proxy-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/netboot-proxy-network.conf	2013-01-22 13:52:41.656544711 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 domain=example.com
 expand-hosts
 local=/example.com/
Index: libvirt-1.0.1/tests/networkxml2confdata/routed-network.conf
===================================================================
--- libvirt-1.0.1.orig/tests/networkxml2confdata/routed-network.conf	2012-12-14 02:45:29.000000000 -0600
+++ libvirt-1.0.1/tests/networkxml2confdata/routed-network.conf	2013-01-22 13:52:43.252544684 -0600
@@ -6,6 +6,7 @@
 ## dnsmasq conf file created by libvirt
 strict-order
 domain-needed
+user=libvirt-dnsmasq
 local=//
 except-interface=lo
 bind-dynamic
